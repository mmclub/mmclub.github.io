
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>南京邮电大学移动互联网俱乐部</title>
  <meta name="author" content="MMClub">

  
  <meta name="description" content="作者: 王涛 项目开发心得——合作篇 第一次做有规模的项目，跟之前的写些小东西相比，主要区别是：那人钱财，给人办事。但是既然是项目，我们就得以集体利益，也就是保质保量的完成东西为最终目标不是？ 与客户交流 需求明确 95%以上的需求要定
改需求 = 做重复劳动 &ndash;> &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mmclub.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="南京邮电大学移动互联网俱乐部" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47454479-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">南京邮电大学移动互联网俱乐部</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mmclub.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/01/think-of-a-outsourcing-app-develpment-2/">关于某App外包开发心得－Android篇（二）</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-01T20:59:40+08:00" pubdate data-updated="true">Jun 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>作者: 王涛</li>
</ul>


<h3>项目开发心得——合作篇</h3>

<p>第一次做有规模的项目，跟之前的写些小东西相比，主要区别是：那人钱财，给人办事。但是既然是项目，我们就得以集体利益，也就是保质保量的完成东西为最终目标不是？</p>

<ol>
<li><h4>与客户交流</h4>

<ol>
<li><h5>需求明确</h5>

<ol>
<li><p>95%以上的需求要定</p></li>
<li><p>改需求 = 做重复劳动 &ndash;> 程序员最难受的事情</p></li>
</ol>
</li>
<li><h5>阶段交付</h5>

<ol>
<li><p>明确交付时间</p></li>
<li><p>阶段交付，确保和客户的需求没有大的偏差</p></li>
</ol>
</li>
</ol>
</li>
<li><h4>与UI交流</h4>

<ol>
<li><h5>设计稿要程序参与</h5>

<ol>
<li><p>设计没有代码经验，难免会做出很多让程序心碎的设计</p>

<blockquote><p>这里最好熟悉AndroidUI设计推荐风格，因为只有越符合标准，越节约体力不是？</p></blockquote></li>
<li><p>相同的功能设计的方式有很多种，有程序的参与会选出既好实现又符合需求的设计</p></li>
<li><p>各个部分的效果要讨论明确，不然程序会做画蛇添足的事</p>

<blockquote><p>例如我就把一个Item按钮写成了N个按钮，而且不只是多多了几个按钮那么简单</p></blockquote></li>
</ol>
</li>
<li><h5>简洁设计，但要完整</h5>

<ol>
<li><p>能够表达清楚叫好了，没必要太花哨</p></li>
<li><p>面面俱到，只要是不用原生的地方都要给出设计资源，这里如果设计师没能考虑周全，我们程序就要做善意的提醒了</p></li>
</ol>
</li>
<li><h5>Android多平台设计需求</h5>

<ol>
<li><p>Android最蛋疼的分辨率适配，要明确需要适配的种类，</p></li>
<li><p>这时候就需要设计师要针对各个分辨率设计包括：</p>

<ol>
<li><p>字号，这里需要说一下，建议不要设计太多种类的字号，想清楚要突出的部分，各个部分的之间的关系</p></li>
<li><p>色系，建议不要太花，定好基调，保持风格一致。</p></li>
<li><p>布局，Padding，Margin，border，corners</p></li>
<li><p>字段，要显示的内容，要明确，不然又要重复劳动，看到这四个字就浑身难受！</p></li>
</ol>
</li>
</ol>
</li>
<li><h5>图片资源交接</h5>

<ol>
<li><p><strong>发送方式</strong></p>

<ol>
<li><p>trello.com是个很好的平台，可以用来上传下载图片，很方便，便于分类管理。</p></li>
<li><p>邮件，速度快，便于保存，但不好分类管理，文件多了容易找不到。</p></li>
</ol>
</li>
<li><p><strong>文件夹命名</strong></p>

<ol>
<li><p>建议根据所属页面命名，按层级分类</p></li>
<li><p>建议用英文例如：Home_Bottom_RadioButton</p></li>
</ol>
</li>
<li><strong>文件命名</strong>

<ol>
<li><p>必须用英文，如果设计用汉字，不仅有乱码风险，而且还得挨个换成英文，累死！</p></li>
<li><p>由于大家对英文单词理解不同，最好先讨论下</p></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><h4>与Web后台交流</h4>

<ol>
<li><p>API的字段要交流好。这就要建立在：需求确定 &ndash;> 设计显示内容确定 &ndash;> 程序实现方式确定 &ndash;> API的字段交流</p></li>
<li><p>API说明文档要交流，不然容易忽略重要内容</p>

<blockquote><p>有个API是数据库要用户信息，我想当然以为是GET，但其实是POST，若是Web后台有特别考虑，要特别说明，不然会出现莫名其妙的错误</p></blockquote></li>
<li><p>更新API要通知，不然会突然找不到数据。尤其是有一次被Web后台坑了，同样的字段，名字却打错了，害我调试好半天</p></li>
</ol>
</li>
<li><h4>与客户端合作者交流</h4>

<ol>
<li><p>项目开始前的计划：</p>

<ol>
<li><p><strong>项目结构：</strong></p>

<ol>
<li><p>代码：Model，Adapter，Activity，View，Utils，Constant</p></li>
<li><p>资源文件：</p>

<ol>
<li><p>定好各个色值，字号，便于调用且统一</p></li>
<li><p>为了适配，建不同分辨率的资源文件，例如</p>

<ul>
<li>values</li>
<li>values-mdpi</li>
<li>values-hdpi</li>
<li>values-xhdpi</li>
</ul>
</li>
<li><p>为了适配，要用demin</p></li>
<li><p>若控件很多且相似，可以用style让代码量减少</p></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>模块划分：</strong>这次做的信息类应用，大致上以页面划分</p></li>
<li><p><strong>View：</strong>下拉菜单，Dialog，Toast，写好接口，方便使用</p></li>
<li><p><strong>Utils：</strong>应用中的某些部分可以做成工具类，文件操作，用户登录信息操作，网络连接检查等</p></li>
<li><p><strong>Constant：</strong>应用中的字符串常量</p></li>
</ol>
</li>
<li><p>开发中遇到变化</p>

<ol>
<li><p>几个人同时改动了一个类要注明，例如：//Foci Add</p></li>
<li><p>了解别人的代码，为了学习，也为了整个项目更好开发</p></li>
</ol>
</li>
</ol>
</li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/01/think-of-a-outsourcing-app-ios-develpment-1/">关于某App外包开发心得－iOS篇（一）</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-01T10:26:47+08:00" pubdate data-updated="true">Jun 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>作者 ： 林翔宇</li>
</ul>


<p>前不久和朋友一起合作了一个外包App项目，我负责iOS和后台Server，另外两名同学合作开发Android端。现在项目已经进入收尾上架工作，我将就开发过程中的一些感想与收获进行总结。</p>

<h2>使用CocoaPods做依赖管理以及开发用到的第三方开源项目</h2>

<p>CocoaPods真是依赖管理神器，比Andorid的Maven或者Gradle方便多了。具体试用可以看看这篇文章<a href="http://blog.devtang.com/blog/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/">唐巧－用CocoaPods做iOS程序的依赖管理
</a></p>

<p>而且最近CocoaPods的Spec有了第三方国内镜像，速度快多了，为什么之前开发的时候木有，加一个库要等半天(ノДＴ) 。 所以我之前修改Podfile后是这样更新的（不更新Spec库并且有提示）：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>pod install --verbose --no-repo-update   </span></code></pre></td></tr></table></div></figure>


<p>我项目里面的第三方依赖有：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>    #import &lt;AVOSCloud/AVOSCloud.h&gt; // AVOSCloud SDK
</span><span class='line'>    #import &lt;MAMapKit/MAMapKit.h&gt;   // 高德地图
</span><span class='line'>    #import &lt;AFNetworking/AFNetworking.h&gt; // AFNetworking 网络通信   
</span><span class='line'>
</span><span class='line'>    #import &lt;UIColor+ChineseColor.h&gt; // 自己的项目复用模块
</span><span class='line'>    #import &lt;MMCommon/MMCommon.h&gt;  
</span><span class='line'>
</span><span class='line'>    #import &lt;SVProgressHUD/SVProgressHUD.h&gt; // 加载提示的HUD
</span><span class='line'>
</span><span class='line'>    #import &lt;Underscore.m/Underscore.h&gt; // Objective-C的类似JavaScript的Underscore.js的辅助库
</span><span class='line'>    
</span><span class='line'>    #import &lt;UMengAnalytics/MobClick.h&gt;  // 友盟统计和SNS集成
</span><span class='line'>    #import &lt;TencentOpenAPI/TencentApiInterface.h&gt;
</span><span class='line'>    #import &lt;TencentOpenAPI/QQApiInterface.h&gt;
</span><span class='line'>    #import &lt;TencentOpenAPI/TencentOAuth.h&gt;
</span><span class='line'>    #import &lt;UMengSocial/UMSocialData.h&gt;
</span><span class='line'>    #import &lt;UMengSocial/UMSocialSnsService.h&gt;
</span><span class='line'>    
</span><span class='line'>    #import &lt;SDWebImage/UIButton+WebCache.h&gt; // 异步图片加载
</span><span class='line'>    #import &lt;SDWebImage/UIImage+GIF.h&gt;
</span><span class='line'>    #import &lt;SDWebImage/UIImageView+WebCache.h&gt;
</span><span class='line'>    #import &lt;SDWebImage/UIImageView+WebCache.h&gt;
</span></code></pre></td></tr></table></div></figure>


<p>不得不提的是使用中。。友盟以及SNS集成过程中，不够清楚的文档以及那些坑的地方，还有调试了几天才发现是SDK悄悄升级，之前的SDK不能用的情况。</p>

<p>在使用的时候，为了更优雅的进行依赖管理，我也为高德地图和友盟SNS创建了Podfile并且提交到了CocoaPods/Spec库里面，需要的童鞋可以看看<a href="https://github.com/oa414/Specs/commits/master">https://github.com/oa414/Specs/commits/master</a></p>

<p>我们同时用了AVOSCloud与友盟，这两个第三方开发者平台功能有很多重复，但是当前各有长处。未来可能迁移到其中一个。</p>

<h2>iOS MVC与界面布局的一些实践</h2>

<p>最初的时候，为了快速开发，全部使用了Storyboard，这让我在一个小时就把几十个页面跳转关系全部做好了。。。而且可以作为原型演示给UI童鞋和Android童鞋看。到后来，发现Storyboard管理几十个页面完全是坑，很多东西代码写更方便，并且即使是23寸的显示器在Interface Building里面拖动各个View也好麻烦。。。于是把这个Tab布局的应用按照五个Tab拆成五个StoryBoard了。主要用代码做布局和跳转，同时取巧用了StoryBoard一些方便的地方。</p>

<p>把各个Tab对应内容分离到不同的StoryBoard的方法：（代码好丑）</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>+(UIViewController *)initViewController :(NSString *)storyBoardName
</span><span class='line'>                            identifier:(NSString *)identifier
</span><span class='line'>                              iconName:(NSString *)iconName
</span><span class='line'>                                 withTag:(int) tag{
</span><span class='line'>    
</span><span class='line'>    UIViewController *vc = [SXAppDelegate viewControllerWithStoryBoard:storyBoardName identifier:identifier];
</span><span class='line'>    UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:vc];
</span><span class='line'>  
</span><span class='line'>    [nav.tabBarItem setImage:[SXAppDelegate getIconImage:iconName]];
</span><span class='line'>    
</span><span class='line'>    nav.tabBarItem.image = [[SXAppDelegate getIconImage:iconName] imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
</span><span class='line'>
</span><span class='line'>    
</span><span class='line'>    UIImage *selectImage = [SXAppDelegate getIconPressedImage:iconName];
</span><span class='line'>    selectImage = [selectImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
</span><span class='line'>    DebugLog(@"select Image %@", selectImage);
</span><span class='line'>    [nav.tabBarItem setSelectedImage:selectImage];
</span><span class='line'>    nav.tabBarItem.selectedImage = selectImage;
</span><span class='line'>    [[UITabBar appearance] setTintColor:[SXAppDelegate getNavColor:iconName]];
</span><span class='line'>    
</span><span class='line'>    nav.tabBarItem.tag = tag;
</span><span class='line'>    
</span><span class='line'>    [nav.tabBarItem setTitleTextAttributes:@{
</span><span class='line'>                                            NSForegroundColorAttributeName : [SXAppDelegate getNavColor:iconName] }     forState:UIControlStateSelected];
</span><span class='line'>
</span><span class='line'>    
</span><span class='line'>    
</span><span class='line'>    NSDictionary *titles = @{
</span><span class='line'>        @"home" : @"首页",
</span><span class='line'>        @"product":@"产品",
</span><span class='line'>        @"news": @"新闻",
</span><span class='line'>        @"my": @"我的",
</span><span class='line'>        @"more": @"更多",
</span><span class='line'>    };
</span><span class='line'>    [nav.tabBarItem setTitle:titles[iconName]];
</span><span class='line'>    return nav;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    self.tabBarController = [[UITabBarController alloc] init];
</span><span class='line'>    
</span><span class='line'>    self.regVC = [SXAppDelegate initViewController:@"My" identifier:@"login" iconName:@"my" withTag:3];
</span><span class='line'>    self.userVC = [SXAppDelegate initViewController:@"My" identifier:@"index" iconName:@"my" withTag:3];
</span><span class='line'>    self.indexVC = [SXAppDelegate initViewController:@"Main" identifier:@"index" iconName:@"home" withTag:0];
</span><span class='line'>    self.productVC = [SXAppDelegate initViewController:@"Product" identifier:@"index" iconName:@"product" withTag:1];
</span><span class='line'>    self.newsVC = [SXAppDelegate initViewController:@"News" identifier:@"index" iconName:@"news" withTag:2];
</span><span class='line'>    self.myVC = self.regVC;
</span><span class='line'>    self.moreVC = [SXAppDelegate initViewController:@"More" identifier:@"index" iconName:@"more" withTag:4];
</span><span class='line'>    
</span><span class='line'>    DebugLog(@"Splash  %@", [SXSplashHelper splashImage]);
</span><span class='line'>    
</span><span class='line'>    if ([SXUser currentUser] == nil){
</span><span class='line'>        [self setRegView];
</span><span class='line'>    }else {
</span><span class='line'>        [self setUserView];
</span><span class='line'>    }
</span><span class='line'>    
</span><span class='line'>    self.window.rootViewController = self.tabBarController;
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h2>宏</h2>

<p>有几个常用的宏可以和大家分享下：</p>

<p>Debug环境下输出Log与行号</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#ifdef DEBUG
</span><span class='line'>#define DebugLog( s, ... ) NSLog( @"[FILE]%@ %*s [LINE]%-*d [METHOD]%@ %*s [MESSAGE]%@", [[NSString stringWithUTF8String:__FILE__] lastPathComponent],30 - ([[[NSString stringWithUTF8String:__FILE__] lastPathComponent] length]),"", 5,__LINE__, NSStringFromSelector(_cmd), 75 - ([NSStringFromSelector(_cmd) length]),"", [NSString stringWithFormat:(s), ##__VA_ARGS__] )
</span><span class='line'>#else
</span><span class='line'>#define DebugLog( s, ... )
</span></code></pre></td></tr></table></div></figure>


<p>用RGB生成UIColor</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#define UIColorFromRGB(rgbValue) [UIColor \
</span><span class='line'>colorWithRed:((float)((rgbValue & 0xFF0000) &gt;&gt; 16))/255.0 \
</span><span class='line'>green:((float)((rgbValue & 0xFF00) &gt;&gt; 8))/255.0 \
</span><span class='line'>blue:((float)(rgbValue & 0xFF))/255.0 alpha:1.0]</span></code></pre></td></tr></table></div></figure>


<p>获取App版本号</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#define APP_VERSION ([[NSBundle mainBundle] objectForInfoDictionaryKey: @"CFBundleShortVersionString"])
</span></code></pre></td></tr></table></div></figure>


<p>判断是否是4寸Retina屏幕</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>IS_IPHONE_5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) &lt; DBL_EPSILON )</span></code></pre></td></tr></table></div></figure>


<h2>让你事倍功半的开发工具</h2>

<p>我觉得有一个外接液晶屏幕很重要。。。</p>

<p>此外是一把比较好的椅子。。</p>

<p>此外，推荐大家试试<a href="http://revealapp.com/">http://revealapp.com/</a>, 一款帮你轻松调试界面的App，收费软件，有试用版本，可以免去改参数－编译－点击查看对应View－改参数－编译的麻烦流程，直接在Reveal里面修改参数就能看到对应效果</p>

<h2>iOS Developer账号的那些坑 与 提交审核</h2>

<h3>iOS Developer 账号</h3>

<p>如果希望认真学习开发iOS App，加入iOS开发者计划是必不可少的。当初为了真机调试，又是找破解Xcode的教程又是在淘宝上买开发者证书，最后还是靠亲爱的妈妈特地办了一张Visa信用卡乖乖付钱交了99美元年费。</p>

<p>但是并不是乖乖叫了钱就一番风顺了。创建一个应用，你需要在开发面板上分别配置开发者证书，应用ID，调试设备，推送证书。。。并且绑定对应调试设备和应用ID。。。推送证书还分开发设备的Sandbox环境和Production环境。。。</p>

<p>相关具体设置可以参见<a href="http://ryantang.me/blog/2013/11/28/apple-account-3/">苹果开发者账号那些事儿</a></p>

<h3>测试分发</h3>

<p>据说TestFlight很不错。。。最近被Apple收购了，我在使用过程中也感到各种不便。不过一些在应用内反馈给测试人员的特性还不错。</p>

<p>最后我发测试包用的是<a href="http://fir.im/">Fir.im</a>，感觉还不错。另外AVOS也提供了相应的功能，值得一试。</p>

<p>同时我也用一个晚上时间做了一个Android APK分发的Demo，放在 <a href="https://github.com/oa414/swan">Github</a>上，希望有空能完善。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/24/think-of-a-outsourcing-app-develpment-1/">关于某App外包开发心得－Android篇（一）</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-24T18:55:07+08:00" pubdate data-updated="true">May 24<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>作者: 戴志强</li>
</ul>


<blockquote><p>前段时间开发了人生的第一个外包App，相对平时做的一些App，有了一定的压力，而且有了更高的要求，不仅仅要有功能上的实现，而且有了更多其他的要求，比如手机的适配，改不完的要求，以及无良android商家对android的修改，比如小米，简直无力吐槽。最后统计java代码量达到了9991行，虽然java比较繁琐，而且我们技术有限，接口以及代码复用做的不太好，但是对于我们还是一个比较大的项目，然而关于这样一个项目是怎么样生成的，希望能给到大家一点启示。</p></blockquote>

<h3>项目功能的初步建模</h3>

<blockquote><p>一个比较大的项目，不管是外包，还是自己想做的，都会有一个大概的功能框架，虽然说做出模型图片，不是程序员的任务，但是通过这次项目，我深深的认识到，一个android的原型图，至少应该派一个程序员与美工(UI设计师~)进行交流，不然他们设计出来的菜单等级，以及酷炫的风格会让你蛋疼无比，然后还会丢下一句“说这么多干什么，不就是做不出来吗？”，为了你的代码难度在你的一定掌握范围内，所以一个靠谱的任必须去和美工一起定原型图，这个非常重要，因为android是没有做到绝对的界面与代码分离，而且基本上美工不懂android布局，所以他们完全不能认识到设计出来的布局到底有多大的难度，这是我遇到的第一个坑。。。</p></blockquote>

<h3>项目功能的考究</h3>

<blockquote><p>终于解决了基本模型的问题，接下来就是功能，无论你是做什么样的软件，功能是离不开的，举个例子，“掌上南邮”我虽然没有参与做，但是看到这个软件，大家都会知道功能有哪些，比如进入界面有个天气预报，用了webservice，接下来的图书馆，用了android中http传输信息然后jsoup爬取图书馆信息，等等。对这些功能做了基本分析，可以将这些技术点分个类，较简单，难，很难，这样你的侧重点，当然还有开发中可能遇到的坑，不要小瞧这一点，一个坑可以让你白忙活一天，还有太难的地方必须有一定的规划，不然就不只是浪费时间了。</p></blockquote>

<h3>项目页面分配</h3>

<blockquote><p>这个也是一个问题，现在做android应用，人多会有，项目结合以及理解性的偏差，所以我的建议是，“能一个人做的不要两个人”，这个真的是很重要，人多力量大主要体现在搬砖，在这里人越少你的代码的统一性更能体现，而且很多的地方都在你的控制范围内，比如数据方法封装。。。但是要两个人或者更多了，这个时候<a href="https://www.github.com">github</a>,<a href="https://trello.com">trello</a>等作为团队合作的神器就来了，更重要的是分配任务时要注意尽量将粘合度比较低的界面分离出去。关于工具类以及接口的整合，我觉得可以先几个人用自己的类写，然后重构时再合到一起，或者还可以让一个比较靠谱的人去写工具类，注意要比较靠谱，因为他的速度要能跟上其他人的速度，为他们提供方法和接口。</p></blockquote>

<h3>项目工程的建立</h3>

<blockquote><p>大家终于要告别一个com.example.Hello写完全部类的时代了，一个好的工程目录可以清晰的看出这个项目的结构，一般不要以com.example中的example因为你提交你的android app到应用市场，他会读出你的包名，如果是example有的是不会接受的。</p></blockquote>

<p>举个项目目录例子：</p>

<pre><code>org.clownxiaoqiang.test
├── adapter
├── util    
├── widget
├── model     
└── ui
    ├── flash
    ├── home     
    ├── shop
    ├── me
    └── more
</code></pre>

<blockquote><p>大家看到的这个例子，分了很多的目录其实还不算标准，在ui下面有了很多，这个就是我们看到的各种界面，一个大的集合为一个，这样不同人在开发时就不会干扰，而且很有序，其实一开始工作做好了，后面的代码重构会简单很多，这里有一个个人开发的<a href="https://github.com/gonjay/rubychina4android">rubychina4android</a>android app，大家可以看下他的工程目录，学习一下。</p></blockquote>

<h3>后记</h3>

<blockquote><p>一个好的写代码习惯也是非常重要的，比如命名，减少冗余代码等，不要小瞧任何一点，同时不要受身边的人干扰，不要认为写android就会低端，如果你能在这条路上做到极致，你也是牛X的，如果再有人对你炫耀他是做底层的，你就把手机丢他脸上，让他自己写app装上去。还有，一个靠谱的包工头，简直太TM重要了。</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/03/start-learning-android/">Android入门杂谈</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-03T00:29:07+08:00" pubdate data-updated="true">Apr 3<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作者: 林翔宇</p>

<h2>入门</h2>

<h3>配置环境</h3>

<ul>
<li>请在<a href="http://www.java.com/zh_CN/">官方网站</a>下载对应的JDK包安装。注意你的系统版本是32位还是64位的，分别下载对应的版本。如果是Windows用户，请尽量按默认选项安装，Mac / Linux用户请用对应的包管理工具安装。这一步出现问题，网上会有很多解决方案。</li>
<li>去<a href="http://developer.android.com/sdk/index.html">Android官方网站</a>下载Android Studio或者ADT Bundle, 分别对应基于Intellij IDLE和Eclipese的Andorid开发IDE，解压就能使用。</li>
</ul>


<h3>学习语言</h3>

<ul>
<li>你需要学习叫Java的一门编程语言，仅需入门，明白基础概念，并能写一些非常简单的小程序就可以了</li>
<li>学到哪里足够了呢？知道<code>if</code>, <code>for</code>, <code>while</code> , 分别是用来干什么的， 知道类，对象，方法是什么东东, 最好能理解抽象类(abtract class)和接口(interface)这种奇怪的东西存在的原因～</li>
<li>书籍推荐 《Head First Java》，适合有任意一门语言基础的，知道<code>if</code>, <code>for</code>, <code>while</code> 以及函数分别是用来干什么的孩子学习。</li>
<li>你并不用十分深入的去学习Java，可以在边学Android的同时学习Java，两者的学习相辅相成。注意：如果你只是想写Android或者Java语言本身，你不必去接触J2EE那些庞大的知识体系，那些和Android基本没什么关系。</li>
<li>不想用Java写Android？当然可以。

<ul>
<li> 你可以选择一些商业的第三方游戏引擎自带支持的语言写Android程序</li>
<li> 熟悉.Net? 试试 <a href="http://xamarin.com/monoforandroid">Xamarin.Android</a></li>
<li> 熟悉Scala或者Clojure? 这些基于JVM的语言也都有对应的写Android程序的方案</li>
<li> 是一个Web开发者? <a href="http://phonegap.com/">PhoneGap</a>, <a href="http://jquerymobile.com/">Jquery Mobile</a>等相关的开源框架在朝你招手。借助HTML5的新特性与强大的基于Webkit的浏览器内核，你也可以用Web前端技术写出不错的Andorid程序。</li>
<li>但是话说回来，绝大多数Android程序还是用Java进行开发，并且用Java开发Android的资料很多很多。所以，尽量还是使用Java吧～</li>
</ul>
</li>
</ul>


<h3>Android入门</h3>

<ul>
<li>官方网站有一整套的<a href="http://developer.android.com/training/index.html">Android Tranning 入门教程</a>, 质量很高而且都是官方的最佳实践，强烈建议一看。</li>
<li>当然官方教程门槛对于0基础的初学者还是有点高，此时建议买一本书学习Android的基本概念和基本入门。毕竟有本书的感觉是不一样的。。。推荐： Apress出版社，Wrox出版社， Orelly出版社的书，国内也引进了一些翻译版本。强烈建议看国外的书，至少能保证条理清晰。</li>
</ul>


<h2>入门到初步掌握</h2>

<p>我建议按照以下步骤来</p>

<ul>
<li>学习最基本的Android概念，会写Hello World，用XML写最简单的布局。</li>
<li>找一本cookbook类型的书，也就是每一小节都带你实现一个小小的功能，让你每次都能接触到新鲜的东西，比较有成就感，而且同时巩固基础。</li>
<li>整理Android概念，比如重新回过头看看<a href="http://developer.android.com/training/index.html">Android Tranning 入门教程</a>，搞明白Activity, Service, Content Provider, Broadcast到底是什么东西，比较熟练的掌握一些常用的功能，比如按钮点击时间，对话框提醒，文件保存，网络资源获取等等。</li>
<li>开始做一些小东西，阅读大量的优秀应用的源代码，学会使用开源库， 阅读<a href="http://developer.android.com/develop/index.html">Android Developer</a>的 Training, API Guide以及 Tools。具体哪个类不明白的话，就去Reference查</li>
<li>最后说一句，这只是个人实践得出来的感觉不算差的方法，我也打算尝试以另一种方式培训0基础的有兴趣的同学，具体的方法可以自己选择，但是我强烈建议2点

<ol>
<li>生命宝贵，有限的时间应该用来约漂亮姑娘(或泡帅哥)，游玩，享受人生，而不是贪图方便看一些国内无厘头或者水分很多的资料</li>
<li>你投入的时间和你的收获正相关，只要付出努力终有回报</li>
</ol>
</li>
</ul>


<h2>资源</h2>

<p>善于利用现有的资源，善于使用第三方开源库</p>

<ul>
<li><a href="https://github.com/">Github</a>  最热门的开源分享网站，你能找到很多<a href="https://github.com/search?q=android&amp;type=Repositories&amp;s=stars">高质量的Android开源库</a></li>
<li><a href="http://www.csdn.net/article/2013-05-03/2815127-Android-open-source-projects">这里</a>有一些第三方开源库的介绍</li>
<li><a href="http://www.appdevwiki.com/wiki/show/HomePage">App Dev Wiki</a></li>
<li><a href="http://www.androidviews.net/">Android Views</a></li>
<li><a href="http://www.theultimateandroidlibrary.com/">The Ultimate Android Library</a></li>
<li>国内最大的论坛应该是<a href="http://www.eoeandroid.com/">eoe</a>, 不过内容比较水。。我偶尔也会去<a href="http://www.oschina.net/android">开源中国</a>逛逛</li>
</ul>


<p>善于在网上寻找答案</p>

<ul>
<li>请务必使用Google而不是百度</li>
<li>学会使用<a href="http://stackoverflow.com/">stackoverflow</a>, 这里有几乎所有细节问题的解决方案</li>
</ul>


<p>善于获取最新资讯</p>

<ul>
<li>关注Google/Android官方的资讯</li>
<li>订阅<a href="http://androiddevweekly.com/">AndroidDevWeekly</a>,每周会发一封最新的资讯到邮箱</li>
</ul>


<h2>发布</h2>

<h3>用户追踪，反馈与推送通知</h3>

<p>用户追踪和反馈可以自己实现客户端功能与服务器端，也可以使用第三方的服务。比如<a href="http://www.umeng.com/">友盟</a>, <a href="https://www.parse.com/">Parse</a> 等。</p>

<p>因为谷歌很多服务，包括推送通知在大陆是被封掉的，建议使用<a href="http://www.jpush.cn/">极光推送</a>,<a href="https://www.parse.com/">Parse</a>的SDK。非常不建议用后台进程轮询的方法查询，费电费流量。</p>

<h3>发布之前</h3>

<ul>
<li>记得对应用进行签名</li>
<li><a href="http://mtc.baidu.com/">百度云测试</a>，<a href="http://www.testin.cn/portal.action?op=Portal.index">云测</a>可以帮你解决众多机型的测试问题</li>
</ul>


<h3>Android市场现状</h3>

<ul>
<li>国内发布Android应用很纠结，机锋，安卓，安智，木蚂蚁，应用汇等等。没有特别的方法，多注册几个账号吧。</li>
<li>强烈建议注册Google Play开发人员，应用无需审核马上就能上架，面向全球市场。注册需要VISA/Mastercard的国际信用卡，以及一次性25美金的费用。</li>
</ul>


<h2>盈利</h2>

<p>这里只谈个人开发者或业余小团队的盈利方式</p>

<p>Android国内收费应用市场很难发展，如果做游戏等应用可以考虑应用内购买的方式。普通应用的盈利方式有</p>

<ul>
<li>广告条。收入低，但是也是一种方式。国内有各种广告商，但是个人推荐<a href="https://zhcn.admob.com">Admob</a></li>
<li>做外包项目。通过关系网接外包项目，或者上<a href="http://elance.com/">Elance</a>，<a href="http://www.freelancer.com/">Freelancer</a>, <a href="https://www.odesk.com/">Odesk</a>接国外外包项目，十分不推荐上猪八戒这些国内网站接项目，市场规范程度和收入远低于国外</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/30/think-of-sohu-competition/">参加搜狐比赛有感</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-30T11:12:39+08:00" pubdate data-updated="true">Mar 30<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作者：苏东生</p>

<p>去年的11月，搜狐公司举办了2014“比武招新”比赛，比赛主要分三个环节：“夺”宝典、“闯”奇关、“攻”擂台，最终优胜者将获得现金大奖和实习offer的奖励。上个学期我和两个老乡一起参加了比赛并且最后拿到了比赛的一等奖，我们自己都有些预想不到，本来只是抱着尝试的态度参加比赛而已。好吧，长话短说，现在跟大家分享一下我参加这次比赛的一些经验和收获吧。</p>

<p>首先是“夺”宝典环节，比较简单，其实也可以算做是一次海选，这个只要你用心按照它的程序去做就能过关，没什么好说的，主要就是让你了解搜狐公司的一些历史和这次比赛的详细情况。</p>

<p>接下来是“闯”奇关环节，也就是所谓的初赛了。初赛的内容有3种选择：一是针对搜狐新闻客户端（android和ios）的产品优化方案，二是搜狐视频客户端的产品优化方案，三是pc端搜狗浏览器的产品优化方案。我们选择的是做搜狐新闻客户端的优化方案，其实当时之前我都没用过android的搜狐新闻客户端，有点坑爹的赶脚，只好临时抱佛脚，把所有的新闻客户端都下了下来仔细的玩了个遍，从各个新闻客户端的特点，优缺点等方面分析，这样我们就开始了有了取长补短的一些观点。接着我们又从它的价值观定位等角度出发考虑提出建立以优质内容为主的新闻客户端生态圈，针对订阅的大板块的优化，提出了深度报道的观点深入挖掘新闻的价值。当然这只是一方面，既然是写优化方案，我们肯定是要考虑得更加长远，所以我们当时从它的发展趋势角度考虑创新性地提出加入SNS化因素，并做了一大堆细节上的考虑，包括流程，图片等。当然说了这么多杂七杂八的东西，也不能就只是一个凭空的想象，要考虑实现你自己观点的技术难度等问题，这就是做为技术人员的我该干的事了。最后总结一下比赛的心得，我认为主要是以下两方面：1.细节 2.创新</p>

<p>说了那么多理论上的东西，你要让别人如何信服你的观点呢，凭什么你的方案就比别人好。并不是你觉得可行它就可行的，没有点群众的基础怎么能行得通呢。所以接下来就是实际行动的时候了，我们做了一份调查问卷并且跑到教学楼大教室收集了200份样本，统计数据并且分析结果。</p>

<p>最后就是最为关键的“攻”擂台环节了，比赛地点也转移到了杭州的浙江大学，队伍到这里也只剩下了4支，除了我们之外的另外3支都是浙大本校的研究生。只有我们是大老远跑过来的本科生，听着这名头都有点惊呆了，压力山大啊。。现场决赛主要有这么几个环节，小牛试刀，即4组同学做各自方案的展示，为了更直观展示我们的观点，我们在最后还做了一个小品类的场景呈现。接着的搜狐论剑，4组队伍两两PK，找出对方方案中的漏洞，感觉有点像辩论赛啊（自信很重要）。。。最后就是评委拿奖的事了。</p>

<p>回想一下这次的比赛，之所以能拿到一等奖，最后经理也点评了，我们在提出任何一个观点的时候，都下足了功夫，做足了功课，并不会说就只是一个口头上的想象而已。正所谓知己知彼，百战百胜。我们有一个观点是增加一个本地新闻栏目，正好经理说在下一个版本里已经加入这个模块了，加上我们有他们其他三个队伍没有的东西，那就是调查问卷，所以就显得更有说服力了。（虽然这更多只是一种形式上的东西，毕竟我们的调查问卷基本都是针对学生，而且有挺多人都是随便写的，很有局限性）但对于比赛来说，这就是经理看中的地方，也是我们最终胜出的一个地方。</p>

<p>所以，做什么事情都不要只是想想或者是口头上说说而已，更多的是要你的实际行动，需要你做足准备，知己知彼，才能百战百胜。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/30/install-ruby-on-rails-on-centos/">How to Install Ruby on Rails on CentOS 6.5 Using Rbenv</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-30T11:11:37+08:00" pubdate data-updated="true">Mar 30<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>Author: Lin Xiangyu</li>
</ul>


<h2>Introduction</h2>

<h3>Ruby on Rails</h3>

<p>Ruby on Rails is one of the most popular web development framework, it&rsquo;s build upon  Ruby Programming Language, and it&rsquo;s the hottest web development stack currently.</p>

<h3>Rbenv</h3>

<p><a href="https://github.com/sstephenson/rbenv">Rbenv</a> is a shell script tools created by <a href="http://sstephenson.us/">Sam Stephenson</a>. It&rsquo;s used for groom your app’s Ruby environment.Use rbenv can pick a Ruby version for your application and guarantee that your development environment matches production.</p>

<p>rbenv works by inserting a directory of shims at the front of your PATH:</p>

<pre><code> ~/.rbenv/shims:/usr/local/bin:/usr/bin:/bin
</code></pre>

<p>Through a process called rehashing, rbenv maintains shims in that directory to match every Ruby command across every installed version of Ruby—irb, gem, rake, rails, ruby, and so on.</p>

<h3>CentOS</h3>

<p>CentOS is derived from  Red Hat Enterprise Linux. The target users of these distributions are usually businesses, which require their systems to be running the most stable way for a long time.So we are going to use  CentOS 6.5 running our applications.</p>

<h2>Step One &ndash; Install dependencies</h2>

<p>Before, installing any package, it&rsquo;s always recommended to update package repository cache use yum.</p>

<pre><code> sudo yum update
</code></pre>

<p>Now,in order to get necessary development tools and dependencies, run the following:</p>

<pre><code> sudo yum groupinstall -y 'development tools'
 sudo yum install -y gcc-c++ glibc-headers openssl-devel readline libyaml-devel readline-devel zlib zlib-devel  sqlite-devel  
</code></pre>

<h2>Step Two &ndash; Install Rbenv and ruby-build</h2>

<p>Then we are ready to get Rbenv downloaded installed, run the following to check out rbenv into ~/.rbenv:</p>

<pre><code> git clone git://github.com/sstephenson/rbenv.git ~/.rbenv
</code></pre>

<p>Add ~/.rbenv/bin to your $PATH for access to the rbenv command-line utility:</p>

<pre><code> echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bash_profile
</code></pre>

<p>Add rbenv init to your shell to enable rbenv shims and autocompletion.</p>

<pre><code> echo 'eval "$(rbenv init -)"' &gt;&gt; ~/.bash_profile
</code></pre>

<p>Ruby-build is a Rbenv plugin which provides the rbenv install command that simplifies the process of installing new Ruby versions. Install rbenv-build:</p>

<pre><code> git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
</code></pre>

<p>reloaded your bash_profile to enable rbenv command:</p>

<pre><code> source ~/.bash_profile
</code></pre>

<h2>Step Three &ndash; Install Ruby</h2>

<p>Install Ruby 2.1.0 and make it the default</p>

<pre><code> rbenv install 2.1.0
 rbenv rehash
 rbenv global 2.1.0
</code></pre>

<p>Now you can run:</p>

<pre><code> ruby -v
</code></pre>

<p>to verify your ruby environment has been installed successful。 It will output something like this:</p>

<pre><code> ruby 2.1.0p0 (2013-12-25 revision 44422) [x86_64-linux]
</code></pre>

<h2>Step Four &ndash; Install Nodejs</h2>

<p>Ruby on Rails need a JavaScript runtime support. It use <a href="https://github.com/sstephenson/execjs">execjs</a> gem which can automatically picks the best runtime available to evaluate your JavaScript program, then returns the result to you as a Ruby object.</p>

<p>ExecJS supports these runtimes:</p>

<ul>
<li>therubyracer &ndash; Google V8 embedded within Ruby</li>
<li>therubyrhino &ndash; Mozilla Rhino embedded within JRuby</li>
<li>Node.js</li>
<li>Apple JavaScriptCore &ndash; Included with Mac OS X</li>
<li>Microsoft Windows Script Host (JScript)</li>
</ul>


<p>So we can use therubyracer gem or  Node.js in with our CentOS and MRI Ruby. In this guide we use <a href="http://nodejs.org/">Nodejs</a> as JavaScript runtime.</p>

<p>Node.js is available from the <a href="https://fedoraproject.org/wiki/EPEL">Fedora Extra Packages for Enterprise Linux (EPEL)</a> repository.</p>

<p>Extra Packages for Enterprise Linux (or EPEL) is a Fedora Special Interest Group that creates, maintains, and manages a high quality set of additional packages for Enterprise Linux, including, but not limited to, Red Hat Enterprise Linux (RHEL), CentOS and Scientific Linux (SL), Oracle Enterprise Linux(OEL).</p>

<p>To check if you have EPEL, run</p>

<pre><code> yum repolist
</code></pre>

<p>if you don&rsquo;t see epel, install it via RPM</p>

<pre><code> rpm -Uvh http://download-i2.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm
</code></pre>

<p>And then run the following command to install node:</p>

<pre><code> sudo yum install nodejs --enablerepo=epel
</code></pre>

<h2>Step Four &ndash; Install Rails Gem and test it.</h2>

<p> Rails 4.0 needs RubyGems 2.0.3, so you have to update your system by using following command</p>

<pre><code> gem update --system 2.0.3
</code></pre>

<p>Now, you can install the rails gem</p>

<pre><code> gem install rails
 rbenv rehash
</code></pre>

<p>Test your rails:</p>

<pre><code> rails new projectname
 cd projectname
 rails server
</code></pre>

<p>now open your browser and open <a href="http://your-server-ip:3000,you">http://your-server-ip:3000,you</a> can find the rails project default page.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/03/puma-a-ruby-web-server-for-concurrent/">Puma: 一个为并发构建的Ruby服务器</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-03T19:14:42+08:00" pubdate data-updated="true">Mar 3<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>本文翻译自Puma官方文档，同时发布于<a href="https://github.com/oa414/puma/blob/master/README.zh.md">Github</a></p>

<p>译者：林翔宇</p>

<h2>概述</h2>

<p>Puma是一个简单，快速，基于线程，并且高并发的面向Ruby/Rack程序的 HTTP 1.1 服务器。Puma同时面向开发和产品环境。为了达到最高的效率，推荐使用一个实现了真正线程的Ruby实现，比如Rubinius或者JRuby。</p>

<h2>为速度和并发构建。</h2>

<p>Puma是一个简单，快速，基于线程，并且高并发的面向Ruby/Rack程序的 HTTP 1.1 服务器。它可以用于任何支持Rack的程序，可以取代Webrick或者Mongrel。它是为了<a href="http://rubini.us">Rubinius</a>而设计的服务器，但是同样可以工作在JRuby和MRI下。Puma同时面向开发和产品环境。</p>

<p>Puam使用了一个继承自Mongrel的C优化的Ragel扩展，来快速并且精确地解析HTTP1.1请求（并且便于移植）。之后，Puma将这些请求放到一个你可以控制的内部线程池的线程之中，所以Puma为你的web应用提供了一个真实的并发环境。</p>

<p>在 Rubinius2.0 中，Puma会用真实的线程利用你所有的CPU核心，这意味着你不用使用多个进程来增加吞吐量。你可以看到在JRuby上类似的优点。</p>

<p>在 MRI中, 因为有全局解释器锁的存在（GIL），同时只能有一个真实的线程在运行。但是当你在做许多IO阻塞的事情的时候（比如HTTP调用像 Twitter的外部API的时候），Puma仍然会通过运行并发运行阻塞的IO调用增加MRI的吞吐量。（ 基于 EventMachine的服务器，如Thin会关掉这个功能，要求你只能使用特别的库）。每个人的选择因实际的应用而异。为了达到最大的吞吐量，强烈推荐使用一个实现了真实线程的Ruby实现，比如<a href="http://rubini.us">Rubinius</a> 或者 <a href="http://jruby.org">JRuby</a>。</p>

<h2>快速入门</h2>

<p>最简单的使用Puma的方式是使用 RubyGems:</p>

<pre><code>$ gem install puma
</code></pre>

<p>现在<code>puma</code>命令已经加入到你的环境变量里了，在你的应用程序根目录下运行下面命令启动你的Rack应用:</p>

<pre><code>$ puma app.ru
</code></pre>

<h2>高级步骤</h2>

<h3>Sinatra</h3>

<p>你可以用下面的命令用Puma运行你的Sinatra应用</p>

<pre><code>$ ruby app.rb -s Puma
</code></pre>

<p>或者在你的应用中设置总是使用Puma</p>

<pre><code>require 'sinatra'
configure { set :server, :puma }
</code></pre>

<p>如果你使用 Bundler,确保你把Puma加入了你的Gemfile中(步骤见下面)。</p>

<h3>Rails</h3>

<p>首先，确保你把Puma加入了你的Gemfile中。</p>

<pre><code>gem 'puma'
</code></pre>

<p>然后用Rails命令启动Puma</p>

<pre><code>$ rails s Puma
</code></pre>

<h3>Rackup</h3>

<p>你可以把Puma作为<code>rackup</code>的选项。</p>

<pre><code>$ rackup -s Puma
</code></pre>

<p>你可以改变你的 <code>config.ru</code> 来默认选择Puma服务器，加入下面的这行:</p>

<pre><code>#\ -s puma
</code></pre>

<h2>配置</h2>

<p>Puma提供了很多控制服务器器运行的选项，完整列表请查阅<code>puma -h</code> (或者 <code>puma --help</code>)</p>

<h3>线程池</h3>

<p>Puma利用了一个你可以改变的动态线程池，你可以通过<code>-t</code> (或者 <code>--threads</code>) 选项:设置最小和最大的线程池里的可以使用的线程数量</p>

<pre><code>$ puma -t 8:32
</code></pre>

<p>Puma会动态的根据当前的负载改变线程数量，默认的数量是<code>0:16</code>, 大胆的尝试吧，但是不要把最大线程数量设置的太大，这会耗尽系统资源。</p>

<h3>集群模式</h3>

<p>Puma 2 提供了集群模式 , 允许你使用 fork出来的进程处理并发处理多个请求。 你可以用-w<code>(or</code>&mdash;workers`) 参数调整运行的work进程数量。</p>

<pre><code>$ puma -t 8:32 -w 3
</code></pre>

<p>在提供真实线程的Ruby实现中，你应该把这个数字调整到和CPU核心数量相同。</p>

<p>注意集群模式下仍然是使用线程的， <code>-t</code> 选项设置每个 worker的进程数量，所以 <code>-w 2 -t 16:16</code> 可能开启了32个线程。</p>

<p>如果你在并发模式你可以选择在启动worker进程前预加载你的应用。如果想利用<a href="https://blog.heroku.com/archives/2013/3/6/matz_highlights_ruby_2_0_at_waza">MRI Ruby 2.0</a>推出的<a href="http://en.wikipedia.org/wiki/Copy-on-write">Copy on Write</a> 的优点的话，这是必要的。只需要调用的时候指定一个 <code>--preload</code> 参数:</p>

<pre><code># CLI invocation
$ puma -t 8:32 -w 3 --preload
</code></pre>

<p>如果你在使用配置文件，使用<code>preload_app!</code>方法，并且使用<code>-C</code>参数指定配置文件:</p>

<pre><code>$ puma -C config/puma.rb

# config/puma.rb
threads 8,32
workers 3
preload_app!
</code></pre>

<p>此外，你可以在配置文件里面定义一个代码块，来在每个工作线程启动的时候运行：</p>

<pre><code># config/puma.rb
on_worker_boot do
  # configuration here
end
</code></pre>

<p>这些代码可以用来在启动应用的时候初始化进程, 允许你做一些和Puma服务器有关，但是不和应用结合的事情。比如，你可以发送一个日志通知Puma启动了。</p>

<p>你可以多次增加钩子调用。</p>

<p>如果你使用ActiveRecord预加载你的应用， 推荐你在这里这样初始化你的连接池：</p>

<pre><code># config/puma.rb
on_worker_boot do
  ActiveSupport.on_load(:active_record) do
    ActiveRecord::Base.establish_connection
  end
end
</code></pre>

<h3>绑定 TCP / Sockets</h3>

<p>相比较其他需要很多配置参数的服务器，Puma仅仅通过<code>-b</code> (或者 <code>--bind</code>)选项使用一个URI参数：</p>

<pre><code>$ puma -b tcp://127.0.0.1:9292
</code></pre>

<p>想通过使用UNIX Sockets来取代TCP么（这能提高5-10%的性能），没问题！</p>

<pre><code>$ puma -b unix:///var/run/puma.sock
</code></pre>

<p>如果你需要改变Unix socket的权限，只需要加入一个umask参数：</p>

<pre><code>$ puma -b 'unix:///var/run/puma.sock?umask=0777'
</code></pre>

<p>希望更加安全？使用 SSL sockets!</p>

<pre><code>$ puma -b 'ssl://127.0.0.1:9292?key=path_to_key&amp;cert=path_to_cert'
</code></pre>

<h3>控制/状态服务</h3>

<p>Puma提供了一个内置的控制/状态服务app来提供对Puam自身的控制，这是一个打开Puma控制服务器的样例：</p>

<pre><code>$ puma --control tcp://127.0.0.1:9293 --control-token foo
</code></pre>

<p>它会在localhost的9293端口打开Puma配置服务器。此外，所有的到控制服务器的请求需要包括一个<code>token=foo</code> 作为查询参数，作为简单的认证。更多app用法参见<a href="https://github.com/puma/puma/blob/master/lib/puma/app/status.rb">status.rb</a>。</p>

<h3>配置文件</h3>

<p>你可以同时使用一个<code>-C</code> (或 <code>--config</code>) 参数提供一个哦诶之文件:</p>

<pre><code>$ puma -C /path/to/config
</code></pre>

<p>请参考 <a href="https://github.com/puma/puma/blob/master/examples/config.rb">示例配置</a> 或者查询 <a href="https://github.com/puma/puma/blob/master/lib/puma/configuration.rb">configuration.rb</a> 查看所有的配置项目</p>

<h2>重启</h2>

<p>Puma有能力在更新版本的时候重启自己，当平台允许的时候(MRI, Rubinius, JRuby),Puma 进行热重启。这是和
 <em>unicorn</em> 和 <em>nginx</em> 在重启的时候保持服务器sockets连接相同的。它可以保证重启的服务器替代旧的服务器的时候请求已经被处理。</p>

<p>Puma有2个内建的重启机制：</p>

<ul>
<li>发送<code>SIGUSR2</code> 信号到<code>puma</code> 进程</li>
<li>使用 status server 和 issue <code>/restart</code></li>
</ul>


<p>当前和重启的进程不会共享代码，所以手动停止Puma并且关闭它也是安全的。</p>

<p>如果新的进程不能加载，它会简单的退出。你应该在生产环境下用一个监控程序运行Puma。</p>

<h3>Cleanup Code</h3>

<p>Puma不能理解所有你的App使用的资源，所以它在你用<code>-C</code>提供的配置文件里面提供了一个叫<code>on_restart</code>的钩子。传递给<code>on_restart</code> 会被Puma在重启自己的时候调用。</p>

<p>你应该在这个代码块里面关闭全局日志文件，redis连接等，这样它们的文件描述符不会在重启的进程里面泄漏。否则会导致文件描述符打开太多，当服务器重启次数很多的时候会导致应用崩溃 。</p>

<h3>平台限制</h3>

<p>不同的平台有差异，下列是Puma在不同平台上有差异的地方</p>

<ul>
<li><strong>JRuby</strong>, <strong>Windows</strong>: 服务器的Socket不能被无缝重启， 这些平台不能通过Ruby传递信息到新的进程</li>
<li><strong>JRuby</strong>, <strong>Windows</strong>: 不支持集群模式 ，因为没有fork  fork(2)</li>
<li><strong>Windows</strong>: 不支持daemon mode ，因为没有fork(2)</li>
</ul>


<h2>pumactl</h2>

<p><code>pumactl</code> 是一个简单的CLI前端来控制或者查看上述的app状态。 请参考  <code>pumactl --help</code></p>

<h2>维护多个Puma  / init.d / upstart 脚本</h2>

<p>如果你想马上得到一个维护多个程序的脚本，请查看用于init.d 和 upstart脚本的<a href="https://github.com/puma/puma/tree/master/tools/jungle">tools/jungle</a></p>

<h2>Capistrano 部署</h2>

<p>Puma 已经被包括进 Capistrano <a href="https://github.com/puma/puma/blob/master/lib/puma/capistrano.rb">deploy script</a>, 你只要 require :</p>

<p>config/deploy.rb</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;puma/capistrano&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>然后</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>cap puma:start
</span><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>cap puma:restart
</span><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>cap puma:stop
</span><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>cap puma:phased_restart
</span></code></pre></td></tr></table></div></figure>


<h2>协议</h2>

<p>Puma 的版权属于Evan Phoenix 和 贡献者. 它基于BSD 协议. 详见LICENSE文件。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/02/decompile-in-android/">Android反编译入门与反编译防范</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-02T22:04:22+08:00" pubdate data-updated="true">Mar 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作者: 林翔宇</p>

<h2>反编译Java代码</h2>

<p>参考<a href="http://www.oschina.net/question/54100_33457">http://www.oschina.net/question/54100_33457</a></p>

<p>文中给出下载链接版本较老，其中dex2jar可能会出现java.lang.OutOfMemoryError的异常。请去官网下载两个工具的最新版。</p>

<ul>
<li><a href="https://code.google.com/p/dex2jar/">https://code.google.com/p/dex2jar/</a></li>
<li><a href="http://java.decompiler.free.fr/?q=jdgui">http://java.decompiler.free.fr/?q=jdgui</a></li>
</ul>


<p>简单来说，用dex2jar把apk文件解压得到的classes.dex转化为jar文件，然后用JD-GUI打开这个Jar文件，查看源码。</p>

<h2>反编译apk生成程序的源代码和图片、XML配置、语言资源等文件</h2>

<p>同样参考<a href="http://www.oschina.net/question/54100_33457">http://www.oschina.net/question/54100_33457</a></p>

<p>使用apktool <a href="https://code.google.com/p/android-apktool/">https://code.google.com/p/android-apktool/</a></p>

<h2>混淆代码防范反编译</h2>

<p>参考 <a href="http://blog.csdn.net/sunboy_2050/article/details/6727640">http://blog.csdn.net/sunboy_2050/article/details/6727640</a></p>

<p><em>2014.3.4更新，感谢俱乐部苏东生同学在评论区提醒</em></p>

<p>新版的SDK在创建工程目录的时候已经提供了默认的模板，将project.properties的中“# proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt”的“#”去掉，再做一些定制就可以了。可以参考</p>

<p><a href="http://blog.csdn.net/brokge/article/details/8989312">http://blog.csdn.net/brokge/article/details/8989312</a></p>

<p><del>修改Android项目下default.properties文件，加上一句proguard.config=proguard.cfg。</del></p>

<p><del>当然同时目录下要有proguard.cfg文件，可以在android_sdk_path/tools/proguard/目录下找</del></p>

<p><del>其实似乎现在Android默认创建工程的时候就已经有了。。看一下default.properties注释就可以了。。。</del></p>

<p><em>注意</em></p>

<p>参考<a href="http://my.oschina.net/banxi/blog/55622">http://my.oschina.net/banxi/blog/55622</a></p>

<ul>
<li>当使用了除了android-support-v4这些API的时候，要添加相对应的声明</li>
<li>可以让proguard帮我们忽略Log.d()这些语句</li>
</ul>


<h2>其他参考资料</h2>

<ul>
<li><a href="http://www.google.co.uk/search?hl=zh-CN&amp;newwindow=1&amp;site=&amp;source=hp&amp;q=Android++decomplier&amp;btnG=Google+%E6%90%9C%E7%B4%A2">Google搜索Android  decomplier</a></li>
<li><a href="http://stackoverflow.com/questions/1249973/decompiling-dex-into-java-sourcecode">StackOverFlow decompiling DEX into Java sourcecode</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/02/android-test-1/">Android测试入门(一) Activity测试简介</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-02T21:54:03+08:00" pubdate data-updated="true">Mar 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作者：林翔宇</p>

<h2>瞎扯</h2>

<p>什么是测试？试想大家写一个程序的时候，经常要手动在命令行下输入测试数据，然后看看程序的输出与实际一不一致。而在做App等UI事件众多的程序的时候，经常要手动点击按钮等控件，看看会不会有预期一样的反应。</p>

<p>大家每次都这样做，累不累呢～有什么好方法可以帮我们节约这些时间从而省出更多时间来约漂亮的女孩子呢～</p>

<p>当然有咯。我们再写一个程序，把这些步骤自动化就行咯。这个程序就是一个测试。</p>

<p>当然软件测试包含的东西很多，我们就来简单扯扯Android测试相关的内容，分几期做一个简单的入门介绍。</p>

<h2>简介</h2>

<p><a href="https://developer.android.com/tools/testing/index.html">Official Doc</a></p>

<p>Android SDK包含了强大的测试工具</p>

<ul>
<li>一个Android Test本身是一个Android Application，并且它的AndroidManifest.xml文件里面有它测试目标的信息</li>
<li>与一个Application不同，Android Test由多个测试用例组成，而不是Android components。</li>
<li>Android测试拥立扩展自JUnit TestCase类，并且可以在测试时发送触摸和键盘输入信息</li>
<li>根据不同的component (application, activity, content provider, or service)，你可以选择不同的Android test 基类</li>
<li>Eclipese/ADT, Intellij IDEA, Android Studio均提供了和Android Test的良好整合</li>
</ul>


<p>一个 Test Application包含了以下几种对于Activity相关的测试</p>

<ul>
<li>启动的初始化状态测试，比如测试一个UI控件是否成功实例化，会不会返回空指针。</li>
<li>UI测试，比如测试按钮点击出现的结果与预期比较一不一样</li>
<li>状态转移时候的测试，当一个Activity在Pause，Start等几个状态之间变换的时候，测试有的控件，变量。</li>
</ul>


<h2>新建一个测试</h2>

<p>在Intellij IDEA中，可以在项目文件下 File &ndash; New Module &ndash; Android Test Module来创建一个测试</p>

<p><img src="http://i.imgur.com/z5M4eF5.png" alt="Intellij New Test Module" /></p>

<p>Intellij IDEA会生成一个类似下面的程序结构</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>MMDailyTest
</span><span class='line'>├── AndroidManifest.xml
</span><span class='line'>├── MMDailyTest.iml
</span><span class='line'>├── ant.properties
</span><span class='line'>├── bin
</span><span class='line'>├── build.xml
</span><span class='line'>├── gen
</span><span class='line'>│   └── org
</span><span class='line'>│       └── nupter
</span><span class='line'>│           └── mmdaily
</span><span class='line'>│               └── tests
</span><span class='line'>│                   ├── BuildConfig.java
</span><span class='line'>│                   ├── Manifest.java
</span><span class='line'>│                   └── R.java
</span><span class='line'>├── libs
</span><span class='line'>├── local.properties
</span><span class='line'>├── proguard-project.txt
</span><span class='line'>├── project.properties
</span><span class='line'>├── res
</span><span class='line'>└── src
</span><span class='line'>    └── org
</span><span class='line'>        └── nupter
</span><span class='line'>            └── mmdaily
</span><span class='line'>                ├── api
</span><span class='line'>                └── ui
</span><span class='line'>                    └── ActivityListActivityTest.java
</span><span class='line'>                    </span></code></pre></td></tr></table></div></figure>


<p>和一个Android App目录基本一致</p>

<p>来看看 AndroidManifest.xml 有什么东西</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
</span><span class='line'><span class="c">&lt;!-- package name must be unique so suffix with &quot;tests&quot; so package loader doesn&#39;t ignore us --&gt;</span>
</span><span class='line'><span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
</span><span class='line'>          <span class="na">package=</span><span class="s">&quot;org.nupter.mmdaily.tests&quot;</span>
</span><span class='line'>          <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
</span><span class='line'>          <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- We add an application tag here just so that we can indicate that</span>
</span><span class='line'><span class="c">         this package needs to link against the android.test library,</span>
</span><span class='line'><span class="c">         which is needed when building test cases. --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;application&gt;</span>
</span><span class='line'>        <span class="nt">&lt;uses-library</span> <span class="na">android:name=</span><span class="s">&quot;android.test.runner&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/application&gt;</span>
</span><span class='line'>    <span class="c">&lt;!--</span>
</span><span class='line'><span class="c">    This declares that this application uses the instrumentation test runner targeting</span>
</span><span class='line'><span class="c">    the package of org.nupter.mmdaily.  To run the tests use the command:</span>
</span><span class='line'><span class="c">    &quot;adb shell am instrument -w org.nupter.mmdaily.tests/android.test.InstrumentationTestRunner&quot;</span>
</span><span class='line'><span class="c">    --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;instrumentation</span> <span class="na">android:name=</span><span class="s">&quot;android.test.InstrumentationTestRunner&quot;</span>
</span><span class='line'>                     <span class="na">android:targetPackage=</span><span class="s">&quot;org.nupter.mmdaily&quot;</span>
</span><span class='line'>                     <span class="na">android:label=</span><span class="s">&quot;Tests for org.nupter.mmdaily&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/manifest&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>默认生成的注释写得很清楚，相比普通的App的AndroidManifest.xml ，多了一个android:name=&ldquo;android.test.runner&#8221;的library依赖，以及一个instrumentation元素，制定了测试的对象的包。</p>

<h2>第一个测试类</h2>

<p>一个测试首先是一个继承自<code>android.test.ActivityInstrumentationTestCase2&lt;YOUR_ACTIVITY_CLASS&gt;</code> 的类</p>

<p>比如我们为ReadPageActivity创建一个ReadPageActivityTest.java</p>

<p>这个ReadPageActivity里面只有一个显示为返回的Button，我们测试按这个按钮的反应，以及这个按钮的文字是不是一直显示为Button</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">org</span><span class="o">.</span><span class="na">nupter</span><span class="o">.</span><span class="na">mmdaily</span><span class="o">.</span><span class="na">ui</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">android.app.Instrumentation</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">android.test.ActivityInstrumentationTestCase2</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">android.widget.Button</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.nupter.mmdaily.R</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Author: linxiangyu</span>
</span><span class='line'><span class="cm"> * Date:   3/2/14</span>
</span><span class='line'><span class="cm"> * Time:   3:24 AM</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReadPageActivityTest</span> <span class="kd">extends</span> <span class="n">ActivityInstrumentationTestCase2</span><span class="o">&lt;</span><span class="n">ReadPageActivity</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="cm">/**</span>
</span><span class='line'><span class="cm">     * 一个Android Activity的Example，是&lt;a href=&quot;https://developer.android.com/tools/testing/testing_android.html&quot;&gt;官方教程的简化版&lt;/a&gt;</span>
</span><span class='line'><span class="cm">     */</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">private</span> <span class="n">ReadPageActivity</span> <span class="n">mActivity</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">Button</span> <span class="n">mButton</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="nf">ReadPageActivityTest</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">(</span><span class="n">ReadPageActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>    <span class="c1">// 整个测试开始之前构建的初始化条件。注意这个构造函数的样子，写错了运行测试的时候这个类就不会被调用了</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">.</span><span class="na">setUp</span><span class="o">();</span>       <span class="c1">// 每个TestCase开始之前都会调用，在这里初始化一些成员变量，可以避免TestCase对变量的修改的影响</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">setActivityInitialTouchMode</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span> <span class="c1">//如果你的测试要触发触摸或者键盘输入，那么必须手动关闭掉Touch Mode</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">mActivity</span> <span class="o">=</span> <span class="n">getActivity</span><span class="o">();</span>    <span class="c1">// 获取activity</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">mButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">mActivity</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span>
</span><span class='line'>               <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">ReadPageBack</span>
</span><span class='line'>        <span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">tearDown</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">.</span><span class="na">tearDown</span><span class="o">();</span>    <span class="c1">// 每个TestCase结束之后都会调用</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPreConditions</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">assertTrue</span><span class="o">(</span><span class="n">mButton</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span> <span class="c1">// 测试一些初始条件，比如你的UI控件不为空。</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testBaseUI</span><span class="o">(){</span>
</span><span class='line'>        <span class="n">assertEquals</span><span class="o">(</span><span class="n">mButton</span><span class="o">.</span><span class="na">getText</span><span class="o">(),</span> <span class="s">&quot;返回&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">mActivity</span><span class="o">.</span><span class="na">runOnUiThread</span><span class="o">(</span>
</span><span class='line'>                <span class="k">new</span> <span class="nf">Runnable</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>                        <span class="n">mButton</span><span class="o">.</span><span class="na">requestFocus</span><span class="o">();</span>
</span><span class='line'>                        <span class="n">mButton</span><span class="o">.</span><span class="na">callOnClick</span><span class="o">();</span>
</span><span class='line'>                    <span class="o">}</span> <span class="c1">//</span>
</span><span class='line'>                <span class="o">});</span> <span class="c1">// UI控件的改变必须这样运行在一个runOnUiThread 中</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">}</span>  <span class="c1">// 测试一些UI事件</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testStatePause</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">Instrumentation</span> <span class="n">mInstr</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getInstrumentation</span><span class="o">();</span>
</span><span class='line'>        <span class="n">mInstr</span><span class="o">.</span><span class="na">callActivityOnPause</span><span class="o">(</span><span class="n">mActivity</span><span class="o">);</span>
</span><span class='line'>        <span class="n">assertEquals</span><span class="o">(</span><span class="n">mButton</span><span class="o">.</span><span class="na">getText</span><span class="o">(),</span> <span class="s">&quot;返回&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span> <span class="c1">// 测试一些App状态转移的时候的样子</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>运行测试</h3>

<p><img src="http://i.imgur.com/1VWC6oS.png" alt="Run Test" /></p>

<p>你会在Intellij 下面的Run窗口里面看到相关的提示，以及你的模拟器/手机迅速跳转到相应的测试Activity，然后又返回来。</p>

<p><img src="http://i.imgur.com/oTD4PMs.png" alt="Test Result" /></p>

<p>很高兴，测试一次通过，全绿。</p>

<h3>项目代码</h3>

<p><a href="https://github.com/mmclub/MMDaily/tree/23ee19d4b25889a5a112f4f6d39e4d306fc8d82b">项目的代码</a></p>

<p>这就是一个最简单的Android测试的样例了，之后我们会介绍其他Android SDK里面测试相关的东西。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/02/design-in-canteen/">设计之食堂有感</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-02T21:53:49+08:00" pubdate data-updated="true">Mar 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作者： 王涛</p>

<p>今天看了知乎上有一个回答<a href="www.zhihu.com/question/22153036">设计成就的关键是“勤奋”还是“天赋”</a>。</p>

<p>里面讲到，看到广告牌就能意识到其设计的好坏，这叫天生。</p>

<p>我不置可否。</p>

<blockquote><p>“设计就是沟通”。</p></blockquote>

<p>后来去食堂吃饭，点了一碗面条，发现没带手机，所以不能用手机里的电子书来利用这个碎片时间。然后我突然想起，刚刚那个的“广告牌”，于是我把注意力放在了食堂一排窗口的广告牌上，上边是统一的，也就是每家都一样，只是名称不同，然后下面都是百事可乐的广告牌，重复而已。</p>

<p>我把注意力放在了百事广告牌上，白色字体，灰色暗部，蓝色背景，从左下角呈喇叭放大的趋势，有种被喊出来的感觉。</p>

<p>接着，四个形象代言人的站位，面向镜头的姿势、表情、动作、发型和服饰，每一个要素想表达的信息无非是，party，欢乐，high。
每一个要素都是可以考究的。
瞬间就觉得自己的视野开阔了许多。</p>

<blockquote><p>设计即生活</p></blockquote>

<p>过了一会，我的面好了，我端方形铁盘，上面放着乘着面的瓷碗，店家考虑到瓷碗太大且烫手，所以用铁盘托之，有点贴心。再来，每天都在用的筷子，勺子，碗，这些我们早已习惯的日常用品，都是经过无数次”设计”过的吧？筷子的形状、长短、材质和手感，勺子的深浅、形状，碗的制作工艺，花纹等等这些随便一个方面都是蕴含无数的”设计“。甚至，面条的发明，菜丝的切法，汤料的制作，这些看似习以为常的”本该如此“或者”本该是厨师的事“其实处处都是设计。</p>

<blockquote><p>“设计就是改善”。</p></blockquote>

<p>吃完，拿出面纸，恩，这面纸的大小、手感和实用性，制作对环境的影响，太多太多了，设计师思维已经打开，收也收不住。世界经济和工业在高速发展，但高速的背后还有很多不合理，不人性，不舒适，不高效，不好用，不美观，不爽的地方，需要用心，细心，有耐心，有爱心的设计师来改善。</p>

<p>吃过饭，我还沉浸在思索当中，餐桌的宽度、桌面的材质，板凳的设计，桌椅的排布，收残车的宽度。。。。好吧，太多了。</p>

<p>出了食堂，看到门口的海报墙，一眼望去，秒秒钟把所有海报的设计水平分的清清楚楚，显然新东方和腾讯的广告海报做的相对精致，PS图层数量应该是其他劣质广告的数倍，甚至数十倍。成本和质量在一定范围内成正比。</p>

<blockquote><p>“天赋决定上限，努力决定下限”，所以，以我们现在的用心和努力程度，根本轮不上比天赋。</p></blockquote>

<p>什么样的心态，就有什么样的环境，不要埋怨现在的环境，努力让自己变强，才能在更好的环境成长，不然去了也是白去。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/06/01/think-of-a-outsourcing-app-develpment-2/">关于某App外包开发心得－Android篇（二）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/01/think-of-a-outsourcing-app-ios-develpment-1/">关于某App外包开发心得－iOS篇（一）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/24/think-of-a-outsourcing-app-develpment-1/">关于某App外包开发心得－Android篇（一）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/03/start-learning-android/">Android入门杂谈</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/30/think-of-sohu-competition/">参加搜狐比赛有感</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mmclub">@mmclub</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mmclub',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - MMClub -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mmclub-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
